# TeamVenture 一期（小程序）QA Checklist & Test Cases

> 基于：交互设计 `docs/design/teamventure-phase1-miniapp-product-design.md` 与接口契约 `docs/design/teamventure-phase1-api-design.md`

---

## 1) 测试范围

### P0 必测旅程
- 登录：微信 code 换 session
- 生成方案：输入→生成→对比→详情
- 确认方案：draft→confirmed
- 联系供应商：拨号/复制 + 服务端记录
- 我的方案：列表分页→详情

### 非功能
- 生成耗时与超时兜底
- 弱网/断网、服务端 5xx、LLM 错误
- 基础兼容：不同机型/系统版本/微信版本

---

## 2) 测试 Checklist（执行清单）

### 2.1 登录与会话
- 未登录访问任何 `/v1/*` 接口返回 `UNAUTHENTICATED`
- session 过期后自动引导重新登录（不死循环）
- token 不落日志（客户端/服务端）

### 2.2 输入校验（生成方案）
- 人数边界：0、1、500、501
- 预算边界：min=0、max<min、极大值（溢出/精度）
- 日期边界：end<start、跨度超限、闰日/跨月
- 城市为空、偏好为空（默认值是否合理）

### 2.3 生成过程（Loading/Timeout）
- <60s 正常返回：展示 3 套方案
- 超时：提示 + 可重试（输入不丢失）
- LLM 异常：提示“稍后重试”，不展示半成品

### 2.4 对比与详情
- 对比页：3 卡片信息一致、排序固定、可进入详情
- 详情页：行程/预算/供应商模块不出现空白块
- 空数据兜底：供应商不足时展示“资源不足”提示

### 2.5 确认方案
- draft 点击确认：状态变更为 confirmed
- 重复确认（幂等）：第二次确认不报错，状态不抖动
- confirmed 在“我的方案”列表状态显示正确

### 2.6 联系供应商
- 拨号：系统能力调用成功/失败提示
- 复制微信：复制成功提示
- 服务端记录：每次联系只记录一次（避免多次点击刷数据，可做节流/去重策略验证）

### 2.7 我的方案
- 列表分页：page/page_size 边界、空列表文案与 CTA
- 详情可复看：状态/内容一致

---

## 3) Test Cases（示例用例表）

> 说明：这里只列核心用例样例；实际执行可按模块扩展到更细粒度。

| ID | 模块 | 用例标题 | 前置条件 | 步骤 | 期望结果 |
|---|---|---|---|---|---|
| TC-LOGIN-001 | 登录 | 微信登录成功 | 小程序可联网 | 触发登录 → 调用 `/v1/auth/wechat/login` | 返回 `session_token`，后续接口鉴权通过 |
| TC-PLAN-001 | 生成 | 合法输入生成成功 | 已登录 | 填写人数/预算/日期/城市/偏好 → 生成 | 60s 内进入对比页，展示 3 套方案 |
| TC-PLAN-002 | 生成 | budget_max < budget_min | 已登录 | 输入 min=50000 max=35000 → 生成 | 前端就地提示或接口返回 `INVALID_ARGUMENT` |
| TC-PLAN-003 | 生成 | 生成超时兜底 | 已登录 | 模拟后端超时 | 展示超时提示 + 可重试，输入不丢 |
| TC-PLAN-010 | 对比 | 从对比进入详情 | 已生成方案 | 对比页点击某方案“查看详情” | 进入详情页，展示行程/预算/供应商 |
| TC-PLAN-020 | 确认 | draft → confirmed | 已生成 draft 方案 | 点击“确认此方案” | 状态变更为 confirmed；列表展示正确 |
| TC-CONTACT-001 | 联系 | 拨号联系供应商 | 详情页有联系方式 | 点击拨号按钮 | 调起拨号；服务端产生一条联系记录 |
| TC-LIST-001 | 列表 | 我的方案列表分页 | 已有 11 条方案 | 打开“我的方案”加载第1页 | 展示 10 条；翻页展示第2页 1条 |
| TC-SEC-001 | 安全 | 未登录请求保护接口 | 未登录/过期 | 调用 `/v1/plans` | 返回 `UNAUTHENTICATED` |

