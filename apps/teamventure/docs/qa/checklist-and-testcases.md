# TeamVenture 一期（小程序）QA Checklist & Test Cases

> 基于：交互设计 `docs/design/teamventure-phase1-miniapp-product-design.md` 与接口契约 `docs/design/teamventure-phase1-api-design.md`

---

## 1) 测试范围

### P0 必测旅程
- 登录：微信 code 换 session
- 生成方案：输入→生成→对比→详情
- 方案状态流转（v1.4 更新）：draft→reviewing→confirmed→archived
- 联系供应商：拨号/复制 + 服务端记录
- 我的方案：列表分页→详情→状态筛选

### 非功能
- 生成耗时与超时兜底
- 弱网/断网、服务端 5xx、LLM 错误
- 基础兼容：不同机型/系统版本/微信版本

---

## 2) 测试 Checklist（执行清单）

### 2.1 登录与会话（v1.2 更新）

#### 两步登录流程
- wx.login() 成功获取 code
- 获取 code 失败时显示友好错误提示
- 用户信息表单正确显示（头像选择器 + 昵称输入框）
- 头像选择器正常弹出并返回临时路径
- 昵称输入框支持微信昵称快速填充（type="nickname"）
- 未选择头像时允许提交，前端显示占位符 👤
- 未输入昵称时允许提交，后端使用默认昵称"微信用户"
- 昵称包含前后空格时自动 trim 处理
- 提交登录请求包含 code、nickname、avatarUrl 三个参数
- 后端成功创建或更新用户记录（users 表）
- 后端返回 sessionToken 和完整 userInfo 对象
- 前端正确存储 token 和 userInfo 到本地 storage
- 登录成功后跳转到首页
- 我的页面正确显示用户头像和昵称
- 头像 URL 过期时（48小时后）显示占位符，不崩溃

#### 退出登录
- 退出登录清除所有本地数据（sessionToken、userInfo）
- 退出登录后页面状态正确重置
- 退出登录后再次访问需登录功能跳转到登录页

#### 会话管理
- 未登录访问任何 `/v1/*` 接口返回 `UNAUTHENTICATED`
- session 过期后自动引导重新登录（不死循环）
- token 不落日志（客户端/服务端）
- 重复登录时正确更新用户信息（nickname、avatar）
- 重复登录时不创建重复用户记录

### 2.2 输入校验（生成方案）
- 人数边界：0、1、500、501
- 预算边界：min=0、max<min、极大值（溢出/精度）
- 日期边界：end<start、跨度超限、闰日/跨月
- 城市为空、偏好为空（默认值是否合理）

### 2.3 生成过程（Loading/Timeout）
- <60s 正常返回：展示 3 套方案
- 超时：提示 + 可重试（输入不丢失）
- LLM 异常：提示“稍后重试”，不展示半成品

### 2.4 对比与详情
- 对比页：3 卡片信息一致、排序固定、可进入详情
- 详情页：行程/预算/供应商模块不出现空白块
- 空数据兜底：供应商不足时展示“资源不足”提示

### 2.5 方案状态流转（v1.4 更新）

#### 提交通晒（draft → reviewing）
- draft 状态方案显示"提交通晒"按钮
- 点击提交通晒：状态变更为 reviewing
- 提交后 review_started_at 字段记录提交时间
- 非 draft 状态不显示提交通晒按钮
- 状态校验：非 draft 状态调用接口返回 INVALID_STATUS

#### 确认方案（reviewing → confirmed）
- reviewing 状态方案显示"确认方案"按钮
- 点击确认：状态变更为 confirmed
- 确认后 confirmed_time 字段记录确认时间
- 重复确认（幂等）：第二次确认不报错，状态不抖动
- 状态校验：非 reviewing 状态调用接口返回 INVALID_STATUS
- confirmed 在"我的方案"列表状态显示正确

#### 回退通晒（confirmed → reviewing）
- confirmed 状态方案显示"回退通晒"按钮
- 点击回退：状态变更为 reviewing
- 回退后 confirmed_time 字段被清除
- 状态校验：非 confirmed 状态调用接口返回 INVALID_STATUS

#### Tab 筛选（v1.4 新增）
- Tab 栏正确显示：全部、制定完成、通晒中、已确认、生成中
- 点击"通晒中"筛选出 reviewing 状态的方案
- 状态标签显示正确："通晒中"

### 2.6 联系供应商
- 拨号：系统能力调用成功/失败提示
- 复制微信：复制成功提示
- 服务端记录：每次联系只记录一次（避免多次点击刷数据，可做节流/去重策略验证）

### 2.7 我的方案

#### 列表展示
- 列表分页：page/page_size 边界、空列表文案与 CTA
- 详情可复看：状态/内容一致
- 出发地显示：已生成方案显示出发城市和日期范围
- 人数显示：列表正确显示人数信息
- 生成中状态：显示进度动画和刷新按钮
- 失败状态：显示重试按钮

#### 左滑操作（v1.3 新增）
- 左滑手势：滑动超过一半时显示操作按钮
- 右滑恢复：右滑或点击其他区域恢复卡片位置
- 按钮布局：归档和删除按钮纵向排列

#### 删除功能（v1.3 新增）
- 删除已生成的方案：成功后从列表移除
- 删除生成中的请求：成功后从列表移除
- 删除失败的请求：成功后从列表移除
- 删除二次确认：点击删除按钮弹出确认弹窗
- 取消删除：确认弹窗点击取消，卡片恢复位置
- 删除幂等：重复删除同一方案不报错
- 权限验证：不能删除他人的方案（403）

#### 归档功能（v1.3 新增，v1.4 更新）
- 归档已确认的方案：成功后从列表移除，状态变为 archived
- **状态约束**：只有 confirmed 状态才能归档（v1.4 新增）
- 归档按钮可见性：只在 confirmed 状态显示归档按钮
- 归档二次确认：点击归档按钮弹出确认弹窗
- 取消归档：确认弹窗点击取消，卡片恢复位置
- 归档幂等：重复归档同一方案不报错
- 状态校验：非 confirmed 状态调用接口返回 INVALID_STATUS
- 权限验证：不能归档他人的方案（403）

### 2.8 首页功能（v1.2 新增）

#### Banner 横幅
- Banner 正确显示文案和样式
- "立即体验"按钮跳转到生成方案页

#### 快捷操作网格
- 4个快捷操作正确显示（生成方案、我的方案、收藏、设置）
- 点击"生成方案"跳转到生成方案Tab
- 点击"我的方案"跳转到我的方案Tab
- 点击"收藏"显示"功能开发中"提示
- 点击"设置"显示"功能开发中"提示

#### 热门目的地
- 横向滚动流畅，无卡顿
- 8个热门目的地正确显示（密云、怀柔、延庆、崇明、平谷、门头沟、十渡、古北水镇）
- 每个目的地显示 emoji 图标和名称
- 点击目的地正确预填到生成方案页的目的地字段
- 预填成功后清除本地存储的临时数据

#### 推荐方案
- 推荐方案列表正确显示（3个精选方案）
- 每个方案显示标题、价格、人数、天数、标签
- 方案卡片样式正确
- 点击方案卡片跳转到详情页（如已实现）

#### 活动类型网格
- 6个活动类型正确显示（3列×2行）
- 每个类型显示 emoji 图标和名称
- 网格布局正确，无错位

### 2.9 我的页面（v1.2 新增）

#### 用户信息卡片（已登录状态）
- 用户头像正确显示（圆形，160rpx）
- 头像URL失效时显示占位符 👤
- 用户昵称正确显示
- 昵称为空时显示"未设置昵称"
- 卡片渐变背景正确显示

#### 用户信息卡片（未登录状态）
- 显示占位符 👤
- 显示"未登录"文字
- 显示"点击登录"按钮
- 点击登录按钮跳转到登录页

#### 统计数据卡片
- 已登录状态显示统计数据（总方案、收藏、已完成）
- 统计数据正确（与实际数据一致）
- 统计数据加载失败时显示占位数据"0"，不影响页面展示
- 未登录状态不显示统计卡片

#### 功能菜单
- 已登录状态显示完整菜单（6项）
- 未登录状态仅显示部分菜单（设置、帮助与反馈、关于我们）
- 点击"我的方案"跳转到我的方案Tab（需登录）
- 点击"我的收藏"显示"功能开发中"提示（需登录）
- 点击"浏览历史"显示"功能开发中"提示（需登录）
- 点击"设置"显示"功能开发中"提示（无需登录）
- 点击"帮助与反馈"显示"功能开发中"提示（无需登录）
- 点击"关于我们"显示关于弹窗，包含版本号（无需登录）
- 未登录访问需登录功能时显示"请先登录"提示，提供"去登录"按钮

#### 退出登录按钮
- 已登录状态显示"退出登录"按钮
- 未登录状态不显示退出按钮
- 点击退出登录弹出确认弹窗
- 确认退出后清除本地数据
- 页面状态正确重置为未登录状态
- 显示"已退出登录"成功提示

#### 页面生命周期
- onShow 时重新检查登录状态
- 登录后返回页面时自动更新用户信息
- 退出登录后页面状态正确更新

---

## 3) 功能覆盖度矩阵（Functional Coverage Matrix）

> 基于实际测试执行情况（参考 `docs/qa/e2e-test-report.md` 和 `docs/qa/integration-test-report.md`）

### 3.1 后端 API 覆盖率

| 功能模块 | 单元测试 | 集成测试 | E2E 测试 | 自动化脚本 | 覆盖率 | 状态 |
|---------|---------|---------|---------|-----------|--------|------|
| **微信登录** | N/A | ✅ | ✅ | `e2e_login_test.sh` | 95% | ✅ 生产就绪 |
| **生成方案** | ✅ | ✅ | ✅ | `e2e_plan_generation_test.sh` | 95% | ✅ 生产就绪 |
| **方案查询** | ✅ | ✅ | ✅ | `run_backend_api_full_coverage.sh` | 90% | ✅ 生产就绪 |
| **方案详情** | ✅ | ✅ | ✅ | Manual | 90% | ✅ 生产就绪 |
| **方案确认** | ✅ | ✅ | ✅ | Manual | 90% | ✅ 生产就绪 |
| **方案删除** | ✅ | ✅ | ✅ | Manual | 90% | ✅ v1.3新增 |
| **方案归档** | ✅ | ✅ | ✅ | Manual | 90% | ✅ v1.3新增 |
| **联系供应商** | ✅ | ✅ | - | Manual | 80% | ✅ 功能可用 |
| **供应商搜索** | ✅ | ✅ | - | Manual | 75% | ✅ 功能可用 |

**总体后端 API 覆盖率**: **87%** ✅

### 3.2 前端功能覆盖率

| 功能模块 | 手动测试指南 | 实际测试 | 覆盖率 | 状态 |
|---------|------------|---------|--------|------|
| **登录流程** | ✅ 完整文档 | ✅ 已测试 | 100% | ✅ 功能完整 |
| **首页** | ✅ 测试清单 | ⚠️ 部分测试 | 80% | ⚠️ 推荐方案待测 |
| **生成方案** | ✅ 完整文档 | ✅ 已测试 | 100% | ✅ 功能完整 |
| **我的方案** | ✅ 完整文档 | ✅ 已测试 | 100% | ✅ 功能完整 |
| **方案详情** | ✅ 测试清单 | ⚠️ 部分测试 | 70% | ⚠️ 待完整测试 |
| **方案对比** | ⚠️ 待补充 | ❌ 未测试 | 0% | ❌ 待测试 |
| **我的页面** | ✅ 测试清单 | ✅ 已测试 | 90% | ✅ 功能完整 |

**总体前端功能覆盖率**: **77%** 🟡

### 3.3 端到端集成覆盖率

| 集成场景 | 覆盖率 | 测试方式 | 状态 |
|---------|--------|---------|------|
| **前端 → 后端 API** | 80% | 手动 + 自动化 | ✅ 主要流程已验证 |
| **后端 → MySQL** | 95% | 自动化 | ✅ 几乎所有操作已验证 |
| **后端 → Redis** | 85% | 自动化 | ✅ Session 管理已测试 |
| **后端 → RabbitMQ** | 70% | 自动化 | ⚠️ 发布验证，消费端待测 |
| **Python AI → Java API** | 0% | - | ❌ 未完整测试 |

**总体集成覆盖率**: **66%** 🟡

---

## 4) Bug 修复跟踪表（Bug Fix Tracking）

> 基于测试报告和 Git 提交历史整理（参考 `docs/qa/buglist.md`）

| Bug ID | 描述 | 严重性 | 发现版本 | 修复状态 | 修复版本 | 验证脚本 | 备注 |
|--------|------|--------|---------|---------|---------|---------|------|
| **BUG-001** | 外部图片加载失败导致小程序崩溃 | P2 | v1.0 | ✅ 已修复 | v1.2 | 手动验证 | 使用占位图片 + 错误处理 |
| **BUG-002** | 登录后我的页面不更新用户信息 | P1 | v1.1 | ✅ 已修复 | v1.2 | `e2e_login_test.sh` | onShow 时重新检查登录状态 |
| **BUG-003** | 偏好部分无法选择（点击无响应） | P1 | v1.0 | ✅ 已修复 | v1.1 | 手动验证 | 修复事件绑定问题 |
| **BUG-004** | ID 字段长度不足导致数据截断 | P0 | v1.0 | ✅ 已修复 | v1.0.1 | DB 迁移脚本 | VARCHAR(32) → VARCHAR(64) |
| **BUG-005** | 方案列表空数据返回 500 错误 | P1 | v1.2 | ⚠️ 待修复 | - | Manual | Service 层缺少空值处理 |
| **BUG-006** | MySQL 中文字符显示乱码 | P2 | v1.0 | 🟡 已文档化 | - | - | 客户端字符集配置问题 |
| **BUG-007** | Emoji 昵称存储失败 | P2 | v1.2 | ⚠️ 待验证 | - | - | 需确认实际影响范围 |
| **BUG-008** | AvatarUrl 长度验证缺失 | P2 | v1.2 | ⚠️ 待修复 | - | - | 添加 @Length(max=500) 注解 |

**Bug 修复统计**:
- ✅ **已修复**: 4 个（P0: 1, P1: 2, P2: 1）
- ⚠️ **待修复**: 3 个（P1: 1, P2: 2）
- 🟡 **已文档化**: 1 个（P2: 1）
- **修复率**: 50% (4/8)

---

## 5) 性能测试用例（Performance Test Cases）

> 基于 `docs/qa/integration-test-report.md` 第8节性能测试结果

### 5.1 API 响应时间基准

| 用例ID | 端点 | 测试场景 | 期望（P95） | 实际（平均） | 实际（最大） | 状态 |
|--------|------|---------|------------|-------------|------------|------|
| **TC-PERF-001** | POST /auth/wechat/login | 新用户登录 | < 500ms | 320ms | 480ms | ✅ 通过 |
| **TC-PERF-002** | POST /plans/generate | 生成方案请求 | < 600ms | 380ms | 520ms | ✅ 通过 |
| **TC-PERF-003** | GET /plans | 方案列表查询（有数据） | < 200ms | 150ms | 220ms | ✅ 通过 |
| **TC-PERF-004** | GET /plans/{id} | 方案详情查询 | < 150ms | 80ms | 150ms | ✅ 通过 |
| **TC-PERF-005** | POST /plans/{id}/confirm | 确认方案 | < 300ms | 180ms | 280ms | ✅ 通过 |
| **TC-PERF-006** | AI 方案生成（端到端） | 提交请求到方案可查看 | < 60s (P95) | - | - | ⚠️ 待测试 |

**性能基准验证结果**: ✅ **所有 API 响应时间 < 600ms，满足移动端体验要求**

### 5.2 并发测试

| 用例ID | 测试场景 | 并发数 | 总请求数 | 成功率 | 平均响应时间 | 状态 |
|--------|---------|--------|---------|--------|-------------|------|
| **TC-PERF-010** | 并发登录 | 10 | 10 | 100% | < 2s (总时长) | ✅ 通过 |
| **TC-PERF-011** | 并发生成方案 | 5 | 5 | 100% | 380ms | ✅ 通过 |
| **TC-PERF-012** | 大规模并发登录 | 100 | 100 | - | - | ⚠️ 待测试 |
| **TC-PERF-013** | 压力测试（1000 req/min） | - | 1000 | - | - | ⚠️ 待测试 |

**并发测试结果**: ✅ **小规模并发（10用户）无问题，大规模待测试**

### 5.3 数据库性能

| 用例ID | 查询场景 | 期望（P95） | 索引使用 | 状态 |
|--------|---------|------------|---------|------|
| **TC-PERF-020** | 方案列表查询（有索引） | < 100ms | `idx_user_id` | ✅ 通过 |
| **TC-PERF-021** | 方案列表查询（带排序） | < 100ms | ⚠️ Using filesort | ⚠️ 需优化 |
| **TC-PERF-022** | 历史方案查询（按时间） | < 100ms | ⚠️ 建议添加复合索引 | ⚠️ 需优化 |

**数据库性能优化建议**:
```sql
-- 优化用户历史方案查询（按创建时间倒序）
CREATE INDEX idx_user_create_time ON plans (user_id, create_time DESC);

-- 优化用户请求历史查询
CREATE INDEX idx_user_request_time ON plan_requests (user_id, create_time DESC);
```

---

## 6) 安全测试用例（Security Test Cases）

> 基于 OWASP Top 10 和实际测试结果

### 6.1 认证与授权

| 用例ID | 测试场景 | 期望结果 | 实际结果 | 状态 |
|--------|---------|---------|---------|------|
| **TC-SEC-001** | 无 Token 访问受保护接口 | 401 Unauthorized | ✅ 401 Unauthorized | ✅ 通过 |
| **TC-SEC-002** | 无效 Token 访问 | 401 Unauthorized | ✅ 401 Unauthorized | ✅ 通过 |
| **TC-SEC-003** | 访问其他用户的资源 | 403 Forbidden | ✅ 403 Forbidden | ✅ 通过 |
| **TC-SEC-004** | Token 泄露防护（日志） | 日志中不显示 Token | ⚠️ 待验证 | ⚠️ 待测试 |
| **TC-SEC-005** | Session 过期处理 | 自动跳转登录 | ✅ 401 → 前端跳转 | ✅ 通过 |

### 6.2 注入攻击防护

| 用例ID | 测试场景 | 攻击payload | 期望结果 | 实际结果 | 状态 |
|--------|---------|------------|---------|---------|------|
| **TC-SEC-010** | SQL 注入防护（昵称） | `' OR '1'='1` | 正常存储为字符串 | ✅ PreparedStatement 转义 | ✅ 通过 |
| **TC-SEC-011** | SQL 注入防护（搜索） | `1'; DROP TABLE users--` | 返回错误或空结果 | ✅ 参数化查询 | ✅ 通过 |
| **TC-SEC-012** | XSS 防护（昵称） | `<script>alert(1)</script>` | 后端存储，前端转义 | ⚠️ 需前端验证 | ⚠️ 待验证 |
| **TC-SEC-013** | XSS 防护（URL） | `javascript:alert(1)` | 拒绝或转义 | ⚠️ 需前端验证 | ⚠️ 待验证 |

### 6.3 敏感信息泄露

| 用例ID | 测试场景 | 期望结果 | 实际结果 | 状态 |
|--------|---------|---------|---------|------|
| **TC-SEC-020** | 错误信息不暴露堆栈 | 仅返回通用错误码 | ✅ 生产环境隐藏堆栈 | ✅ 通过 |
| **TC-SEC-021** | 数据库连接信息隐藏 | 响应中无 DB 信息 | ✅ 无泄露 | ✅ 通过 |
| **TC-SEC-022** | JWT 不包含敏感信息 | 仅 user_id + 过期时间 | ✅ 无敏感信息 | ✅ 通过 |
| **TC-SEC-023** | 日志脱敏 | 密码/Token 脱敏 | ⚠️ 待审查日志配置 | ⚠️ 待测试 |

### 6.4 CSRF 与 CORS

| 用例ID | 测试场景 | 期望结果 | 实际结果 | 状态 |
|--------|---------|---------|---------|------|
| **TC-SEC-030** | CSRF 防护 | 拒绝跨域请求（生产） | ⚠️ 待配置 CORS | ⚠️ 待测试 |
| **TC-SEC-031** | CORS 配置正确性 | 仅允许白名单域名 | ⚠️ 待生产环境验证 | ⚠️ 待测试 |

**安全测试总结**:
- ✅ **认证授权**: 8/9 通过
- ✅ **SQL 注入防护**: 完全通过（MyBatis PreparedStatement）
- ⚠️ **XSS 防护**: 后端存储安全，前端需验证转义
- ⚠️ **CSRF/CORS**: 待生产环境配置验证

---

## 7) 边界测试用例（Boundary Test Cases）

### 7.1 数值边界

| 用例ID | 测试字段 | 边界值 | 期望结果 | 实际结果 | 状态 |
|--------|---------|--------|---------|---------|------|
| **TC-EDGE-001** | people_count | 0 | 400 Bad Request | ✅ 400 | ✅ 通过 |
| **TC-EDGE-002** | people_count | 1 | 200 OK | ✅ 200 | ✅ 通过 |
| **TC-EDGE-003** | people_count | 500 | 200 OK | ✅ 200 | ✅ 通过 |
| **TC-EDGE-004** | people_count | 501 | 400 Bad Request | ✅ 400 | ✅ 通过 |
| **TC-EDGE-005** | people_count | 10000 | 400 Bad Request | ✅ 400 | ✅ 通过 |
| **TC-EDGE-010** | budget_min | 0 | 400 Bad Request | ⚠️ 待验证 | ⚠️ 待测试 |
| **TC-EDGE-011** | budget_max < budget_min | min=20000, max=10000 | 400 Bad Request | ✅ 400 | ✅ 通过 |
| **TC-EDGE-012** | budget_max | 极大值（1e12） | 400 或接受 | ⚠️ 待验证 | ⚠️ 待测试 |

### 7.2 日期边界

| 用例ID | 测试场景 | 边界值 | 期望结果 | 实际结果 | 状态 |
|--------|---------|--------|---------|---------|------|
| **TC-EDGE-020** | end_date < start_date | start=2026-02-10, end=2026-02-01 | 400 Bad Request | ⚠️ 待验证 | ⚠️ 待测试 |
| **TC-EDGE-021** | 跨月日期 | start=2026-01-31, end=2026-02-02 | 200 OK | ⚠️ 待验证 | ⚠️ 待测试 |
| **TC-EDGE-022** | 闰日 | 2024-02-29 | 200 OK | ⚠️ 待验证 | ⚠️ 待测试 |
| **TC-EDGE-023** | 非法日期格式 | "2026/02/01" (斜杠) | 400 Bad Request | ✅ 400 | ✅ 通过 |
| **TC-EDGE-024** | 过去日期 | start_date < 今天 | 400 或接受 | ⚠️ 待验证 | ⚠️ 待测试 |

### 7.3 字符串边界

| 用例ID | 测试字段 | 边界值 | 期望结果 | 实际结果 | 状态 |
|--------|---------|--------|---------|---------|------|
| **TC-EDGE-030** | nickname | 空字符串 "" | 使用默认值 "微信用户" | ✅ 默认值 | ✅ 通过 |
| **TC-EDGE-031** | nickname | 仅空格 "   " | 使用默认值 | ✅ Trim 后默认值 | ✅ 通过 |
| **TC-EDGE-032** | nickname | 64 字符（边界内） | 200 OK | ⚠️ 待验证 | ⚠️ 待测试 |
| **TC-EDGE-033** | nickname | 65+ 字符（超长） | 400 或截断 | ⚠️ 待验证 | ⚠️ 待测试 |
| **TC-EDGE-034** | avatarUrl | 空字符串 | 200 OK（存储空串） | ✅ 200 | ✅ 通过 |
| **TC-EDGE-035** | avatarUrl | 500+ 字符（超长） | 400 Bad Request | ❌ 500 错误 | ⚠️ 需修复 |

### 7.4 空值处理

| 用例ID | 测试场景 | 期望结果 | 实际结果 | 状态 |
|--------|---------|---------|---------|------|
| **TC-EDGE-040** | preferences 为空对象 {} | 200 OK | ✅ 200 | ✅ 通过 |
| **TC-EDGE-041** | preferences 缺失（不传） | 200 OK | ✅ 200 | ✅ 通过 |
| **TC-EDGE-042** | preferences 为 null | 200 OK | ⚠️ 待验证 | ⚠️ 待测试 |
| **TC-EDGE-043** | 方案列表为空 | 返回空数组 [] | ❌ 500 错误 | ⚠️ 需修复 |

**边界测试总结**:
- ✅ **数值边界**: 主要场景已覆盖
- ⚠️ **日期边界**: 部分场景待验证
- ⚠️ **字符串边界**: 超长字符串处理需加强
- ⚠️ **空值处理**: 方案列表空数据需修复

---

## 8) Test Cases（核心用例表）

> 说明：这里只列核心用例样例；详细用例参考 `docs/qa/backend-api-testcases-full.md`。

| ID | 模块 | 用例标题 | 前置条件 | 步骤 | 期望结果 |
|---|---|---|---|---|---|
| TC-LOGIN-001 | 登录 | 微信登录成功 | 小程序可联网 | 触发登录 → 调用 `/v1/auth/wechat/login` | 返回 `session_token`，后续接口鉴权通过 |
| TC-PLAN-001 | 生成 | 合法输入生成成功 | 已登录 | 填写人数/预算/日期/城市/偏好 → 生成 | 60s 内进入对比页，展示 3 套方案 |
| TC-PLAN-002 | 生成 | budget_max < budget_min | 已登录 | 输入 min=50000 max=35000 → 生成 | 前端就地提示或接口返回 `INVALID_ARGUMENT` |
| TC-PLAN-003 | 生成 | 生成超时兜底 | 已登录 | 模拟后端超时 | 展示超时提示 + 可重试，输入不丢 |
| TC-PLAN-010 | 对比 | 从对比进入详情 | 已生成方案 | 对比页点击某方案"查看详情" | 进入详情页，展示行程/预算/供应商 |
| TC-PLAN-020 | 确认 | draft → confirmed | 已生成 draft 方案 | 点击"确认此方案" | 状态变更为 confirmed；列表展示正确 |
| TC-CONTACT-001 | 联系 | 拨号联系供应商 | 详情页有联系方式 | 点击拨号按钮 | 调起拨号；服务端产生一条联系记录 |
| TC-LIST-001 | 列表 | 我的方案列表分页 | 已有 11 条方案 | 打开"我的方案"加载第1页 | 展示 10 条；翻页展示第2页 1条 |
| TC-SEC-001 | 安全 | 未登录请求保护接口 | 未登录/过期 | 调用 `/v1/plans` | 返回 `UNAUTHENTICATED` |

