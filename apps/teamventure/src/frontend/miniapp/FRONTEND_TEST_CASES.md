# TeamVenture 小程序前端测试用例文档

**版本**: v1.0
**创建日期**: 2026-01-02
**测试环境**: Local
**文档状态**: ✅ Ready for Testing

---

## 📋 目录

1. [测试环境准备](#1-测试环境准备)
2. [系统架构](#2-系统架构)
3. [测试前置条件](#3-测试前置条件)
4. [UI 测试用例](#4-ui-测试用例)
5. [功能测试用例](#5-功能测试用例)
6. [集成测试用例](#6-集成测试用例)
7. [API 测试用例](#7-api-测试用例)
8. [性能测试用例](#8-性能测试用例)
9. [边界测试用例](#9-边界测试用例)
10. [兼容性测试用例](#10-兼容性测试用例)
11. [测试数据](#11-测试数据)
12. [测试报告模板](#12-测试报告模板)

---

## 1. 测试环境准备

### 1.1 后端系统启动

#### 📍 系统组件

后端系统包含以下组件（通过 Docker Compose 编排）：

**核心服务**:
- ✅ Nginx API Gateway (端口: 80, 443)
- ✅ Java 业务服务 - Spring Boot (端口: 8080)
- ✅ Python AI 服务 - FastAPI (端口: 8000)

**基础设施**:
- ✅ MySQL 主库 (端口: 3306)
- ✅ MySQL 从库 (端口: 3307)
- ✅ Redis 缓存 (端口: 6379)
- ✅ RabbitMQ 消息队列 (端口: 5672, 管理界面: 15672)

**监控组件**:
- ✅ Prometheus (端口: 9090)
- ✅ Grafana (端口: 3000)
- ✅ Node Exporter (端口: 9100)
- ✅ cAdvisor (端口: 8081)
- ✅ Nginx Exporter (端口: 9113)

---

#### 🚀 启动步骤

##### Step 1: 进入项目目录

```bash
cd /Users/qitmac001395/workspace/QAL/ideas/apps/teamventure/src
```

##### Step 2: 检查环境配置文件

确保 `.env.local` 文件存在并配置正确：

```bash
# 查看环境配置
cat .env.local

# 如果不存在，创建 .env.local 文件
cp .env.example .env.local  # 如果有示例文件
```

**关键配置项**:
```bash
# 数据库
MYSQL_ROOT_PASSWORD=root123456
MYSQL_DATABASE=teamventure_main

# Redis
REDIS_PASSWORD=redis123456

# RabbitMQ
RABBITMQ_USER=admin
RABBITMQ_PASSWORD=admin123456

# OpenAI (AI 服务需要)
OPENAI_API_KEY=your-openai-api-key
OPENAI_MODEL=gpt-4-0125-preview

# 内部服务密钥
TEAMVENTURE_AI_SERVICE_CALLBACK_SECRET=change-this-in-production
JAVA_INTERNAL_SECRET=change-this-in-production
```

##### Step 3: 启动所有服务

```bash
# 启动所有服务（后台运行）
docker-compose up -d

# 查看启动日志
docker-compose logs -f

# 或者分别查看各服务日志
docker-compose logs -f nginx
docker-compose logs -f java-business-service
docker-compose logs -f python-ai-service
```

##### Step 4: 验证服务状态

```bash
# 查看所有容器状态
docker-compose ps

# 预期输出应显示所有服务为 "Up" 或 "healthy" 状态
```

**健康检查**:

```bash
# MySQL 主库
docker exec teamventure-mysql-master mysqladmin ping -h localhost -uroot -proot123456

# Redis
docker exec teamventure-redis redis-cli -a redis123456 ping

# RabbitMQ
docker exec teamventure-rabbitmq rabbitmq-diagnostics -q ping

# Java 服务健康检查
curl http://localhost:8080/actuator/health

# Python 服务健康检查
curl http://localhost:8000/health

# Nginx
curl http://localhost/
```

##### Step 5: 访问管理界面

- **RabbitMQ 管理界面**: http://localhost:15672
  - 用户名: `admin`
  - 密码: `admin123456`

- **Grafana 监控界面**: http://localhost:3000
  - 用户名: `admin`
  - 密码: `admin`

- **Prometheus**: http://localhost:9090

##### Step 6: 初始化数据库（如需要）

```bash
# 如果数据库需要初始化，执行 SQL 脚本
docker exec -i teamventure-mysql-master mysql -uroot -proot123456 teamventure_main < ./database/schema/init.sql
```

---

#### 🛑 停止服务

```bash
# 停止所有服务
docker-compose down

# 停止并删除数据卷（慎用！会清空所有数据）
docker-compose down -v
```

---

### 1.2 前端环境配置

#### Step 1: 配置 /etc/hosts

确保域名映射正确：

```bash
# 编辑 hosts 文件
sudo nano /etc/hosts

# 添加以下行（如果还没有）
127.0.0.1       api.teamventure.com
```

#### Step 2: 配置前端环境

编辑 `utils/config.js`:

```javascript
// 1. 关闭模拟数据模式（连接真实后端）
export const USE_MOCK_DATA = false  // ❌ 改为 false

// 2. 确认环境为 local
const ENV = 'local'  // ✅ local 环境

// 3. API 地址通过 hosts 解析到本地
const API_BASE_URLS = {
  local: 'http://api.teamventure.com/api/v1'  // ✅ 解析到 127.0.0.1
}
```

#### Step 3: 打开微信开发者工具

1. 导入项目目录: `/Users/qitmac001395/workspace/QAL/ideas/apps/teamventure/src/frontend/miniapp`
2. AppID: 选择「测试号」
3. 设置 → 项目设置 → 本地设置
   - ✅ 勾选「不校验合法域名」
4. 点击「编译」

---

## 2. 系统架构

### 2.1 架构图

```
┌─────────────────────────────────────────────────────────────┐
│                      微信小程序前端                          │
│                 (WeChat Mini Program)                       │
└─────────────────────┬───────────────────────────────────────┘
                      │ HTTP/HTTPS
                      ↓
┌─────────────────────────────────────────────────────────────┐
│                   Nginx API Gateway                         │
│              (api.teamventure.com:80/443)                   │
└──────────┬─────────────────────────┬────────────────────────┘
           │                         │
           ↓                         ↓
┌──────────────────────┐   ┌────────────────────────┐
│  Java 业务服务        │   │  Python AI 服务         │
│  (Spring Boot:8080)  │←→│  (FastAPI:8000)        │
└──────────┬───────────┘   └────────┬───────────────┘
           │                        │
           ↓                        ↓
┌──────────────────────────────────────────────────┐
│              基础设施层                           │
│  ┌─────────┐  ┌───────┐  ┌──────────┐           │
│  │  MySQL  │  │ Redis │  │ RabbitMQ │           │
│  │ 主/从库  │  │ Cache │  │   MQ     │           │
│  └─────────┘  └───────┘  └──────────┘           │
└──────────────────────────────────────────────────┘
           │
           ↓
┌──────────────────────────────────────────────────┐
│              监控层                               │
│  Prometheus → Grafana (数据可视化)               │
└──────────────────────────────────────────────────┘
```

### 2.2 API 请求流程

```
小程序 → Nginx → Java Service → 响应
                  ↓
                  Python AI (异步方案生成)
                  ↓
                  RabbitMQ
                  ↓
                  AI 生成完成 → 回调 Java Service
```

---

## 3. 测试前置条件

### 3.1 环境检查清单

- [ ] Docker 已安装并运行
- [ ] Docker Compose 已安装
- [ ] 所有后端服务已启动并健康
- [ ] /etc/hosts 已配置域名映射
- [ ] 微信开发者工具已安装
- [ ] 前端项目已导入到微信开发者工具
- [ ] 前端配置 USE_MOCK_DATA = false

### 3.2 测试账号

| 类型 | 账号信息 | 说明 |
|------|----------|------|
| 测试用户 | 微信授权登录 | 使用微信开发者工具测试号 |
| 管理员 | admin/admin123 | 后台管理（如有） |

### 3.3 测试数据准备

详见 [11. 测试数据](#11-测试数据) 章节

---

## 4. UI 测试用例

### 4.1 登录页 (pages/login)

| 用例ID | 测试项 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| UI-LOGIN-001 | 页面布局 | 打开登录页 | 渐变背景、Logo、标题、功能亮点卡片、授权按钮正常显示 | P0 |
| UI-LOGIN-002 | 渐变动画 | 观察背景 | 蓝色渐变背景显示正常 | P1 |
| UI-LOGIN-003 | 功能亮点卡片 | 查看卡片内容 | 显示 3 个功能亮点，图标和文字对齐 | P1 |
| UI-LOGIN-004 | 用户协议勾选框 | 点击勾选框 | 可正常勾选/取消勾选 | P0 |
| UI-LOGIN-005 | 授权按钮状态 | 未勾选协议时点击 | 按钮应禁用或提示需要同意协议 | P0 |
| UI-LOGIN-006 | 响应式布局 | 在不同设备上查看 | 在不同屏幕尺寸下布局正常 | P1 |

### 4.2 生成方案页 - Step 1 (pages/index)

| 用例ID | 测试项 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| UI-INDEX-001 | Step 指示器 | 查看顶部步骤条 | 显示 Step 1 和 Step 2，当前在 Step 1 | P0 |
| UI-INDEX-002 | 人数输入组件 | 查看 Stepper 组件 | 显示 - 号、数字、+ 号，默认值为 50 | P0 |
| UI-INDEX-003 | 快捷人数按钮 | 查看快捷按钮 | 显示 20人、50人、100人 三个按钮 | P1 |
| UI-INDEX-004 | 预算输入框 | 查看输入框 | 最低预算和最高预算输入框显示正常，带千分位 | P0 |
| UI-INDEX-005 | 人均预算提示 | 输入预算 | 实时显示人均预算计算结果 | P1 |
| UI-INDEX-006 | 日期选择器 | 点击日期输入 | 弹出日期选择器 | P0 |
| UI-INDEX-007 | 天数计算 | 选择开始和结束日期 | 自动计算并显示天数 | P1 |
| UI-INDEX-008 | 出发地点输入 | 查看输入框 | 显示地点输入框，支持文本输入 | P0 |
| UI-INDEX-009 | 下一步按钮 | 查看按钮 | 按钮位于底部，样式突出 | P0 |

### 4.3 生成方案页 - Step 2 (pages/index)

| 用例ID | 测试项 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| UI-INDEX-010 | Step 指示器 | 从 Step 1 点击下一步 | Step 2 高亮，Step 1 显示完成状态 | P0 |
| UI-INDEX-011 | 活动类型选择 | 查看标签组 | 显示 4 种活动类型，支持多选 | P0 |
| UI-INDEX-012 | 住宿标准选择 | 查看单选组 | 显示 3 种住宿标准，单选 | P0 |
| UI-INDEX-013 | 餐饮偏好选择 | 查看标签组 | 显示 4 种餐饮偏好，支持多选 | P0 |
| UI-INDEX-014 | 特殊需求输入 | 查看文本域 | 显示多行文本输入框 | P1 |
| UI-INDEX-015 | 上一步按钮 | 查看按钮 | 显示「上一步」按钮 | P0 |
| UI-INDEX-016 | 生成方案按钮 | 查看按钮 | 显示「生成方案」按钮，样式突出 | P0 |

### 4.4 方案对比页 (pages/comparison)

| 用例ID | 测试项 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| UI-COMP-001 | 页面标题 | 查看页面 | 显示「为您推荐 3 套方案」 | P1 |
| UI-COMP-002 | 方案卡片布局 | 查看卡片 | 3 个方案卡片横向排列，可滚动 | P0 |
| UI-COMP-003 | 推荐标签 | 查看卡片 | 推荐方案显示「推荐」标签 | P1 |
| UI-COMP-004 | 方案类型标签 | 查看卡片 | 显示方案类型（经济型/平衡型/品质型） | P0 |
| UI-COMP-005 | 总价和人均 | 查看卡片 | 显示总价和人均费用，金额格式正确 | P0 |
| UI-COMP-006 | 适合人群标签 | 查看卡片 | 显示适合人群标签 | P1 |
| UI-COMP-007 | 选中状态 | 点击卡片 | 卡片显示选中边框和背景色 | P0 |
| UI-COMP-008 | 对比表格 | 查看底部 | 显示「查看详细对比」按钮 | P0 |
| UI-COMP-009 | 展开对比表 | 点击展开 | 对比表展开，显示 3 列方案对比数据 | P0 |
| UI-COMP-010 | 操作按钮 | 查看底部 | 显示「查看详情」和「选择此方案」按钮 | P0 |

### 4.5 方案详情页 (pages/detail)

| 用例ID | 测试项 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| UI-DETAIL-001 | 概览卡片 | 查看顶部 | 显示方案名称、类型、总价、人均、天数等信息 | P0 |
| UI-DETAIL-002 | 行程面板 | 查看面板 | 显示「行程安排」面板，默认展开 | P0 |
| UI-DETAIL-003 | 时间线样式 | 查看行程 | 时间线左侧对齐，时间点和活动清晰 | P1 |
| UI-DETAIL-004 | 预算明细（非MVP） | 查看面板 | 不展示预算明细模块 | P0 |
| UI-DETAIL-005 | 预算分类（非MVP） | 展开预算面板 | 不展示预算明细模块 | P0 |
| UI-DETAIL-006 | 供应商面板（非MVP） | 查看面板 | 不展示供应商模块 | P0 |
| UI-DETAIL-007 | 供应商卡片（非MVP） | 展开供应商面板 | 不展示供应商模块 | P0 |
| UI-DETAIL-008 | 联系按钮（非MVP） | 查看按钮 | 不展示供应商模块 | P0 |
| UI-DETAIL-009 | 底部按钮 | 查看底部 | 显示「确认选择此方案」按钮 | P0 |
| UI-DETAIL-010 | 折叠图标 | 点击面板标题 | 显示展开/折叠图标，动画流畅 | P1 |

### 4.6 我的方案页 (pages/myplans)

| 用例ID | 测试项 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| UI-MYPLANS-001 | 空状态 | 无方案时查看 | 显示空状态图标和提示文字 | P1 |
| UI-MYPLANS-002 | 引导按钮 | 空状态时 | 显示「去生成方案」按钮 | P1 |
| UI-MYPLANS-003 | 方案列表 | 有方案时查看 | 方案卡片纵向排列 | P0 |
| UI-MYPLANS-004 | 方案卡片信息 | 查看卡片 | 显示方案名称、日期、人数、总价、状态 | P0 |
| UI-MYPLANS-005 | 状态标签 | 查看状态 | 不同状态显示不同颜色（草稿/已确认/已取消） | P0 |
| UI-MYPLANS-006 | 滑动删除提示 | 向左滑动卡片 | 显示「删除」按钮，背景为红色 | P1 |
| UI-MYPLANS-007 | 下拉刷新 | 下拉页面 | 显示刷新动画 | P1 |

### 4.7 TabBar 导航

| 用例ID | 测试项 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| UI-TAB-001 | TabBar 显示 | 查看底部 | 显示 2 个 Tab（生成方案、我的方案） | P0 |
| UI-TAB-002 | Tab 文字 | 查看文字 | 文字清晰，未选中为灰色，选中为蓝色 | P0 |
| UI-TAB-003 | Tab 切换 | 点击 Tab | 切换流畅，页面正确跳转 | P0 |
| UI-TAB-004 | 选中状态 | 切换 Tab | 当前 Tab 高亮显示 | P0 |

---

## 5. 功能测试用例

### 5.1 登录功能

| 用例ID | 测试项 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|----------|--------|
| FUNC-LOGIN-001 | 微信授权登录 | 未登录 | 1. 打开登录页<br>2. 勾选用户协议<br>3. 点击「微信授权登录」 | 调用微信授权 API，获取用户信息，登录成功后跳转首页 | P0 |
| FUNC-LOGIN-002 | 未勾选协议登录 | 未登录 | 1. 打开登录页<br>2. 不勾选协议<br>3. 点击登录 | 提示「请先同意用户协议」 | P0 |
| FUNC-LOGIN-003 | 登录状态保持 | 已登录 | 1. 登录成功<br>2. 关闭小程序<br>3. 重新打开 | 自动登录，直接进入首页 | P1 |
| FUNC-LOGIN-004 | 登录失败处理 | 未登录 | 1. 模拟网络错误<br>2. 尝试登录 | 显示登录失败提示，可重试 | P1 |

### 5.2 方案生成功能

| 用例ID | 测试项 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|----------|--------|
| FUNC-GEN-001 | 完整流程生成 | 已登录 | 1. 填写所有必填项<br>2. 点击下一步<br>3. 选择偏好<br>4. 点击生成方案 | 显示加载动画，请求后端 API，成功后跳转到对比页 | P0 |
| FUNC-GEN-002 | 表单验证 - 人数 | 已登录 | 1. 人数输入为 0<br>2. 点击下一步 | 提示「请输入参与人数」 | P0 |
| FUNC-GEN-003 | 表单验证 - 预算 | 已登录 | 1. 不填写预算<br>2. 点击下一步 | 提示「请输入预算范围」 | P0 |
| FUNC-GEN-004 | 表单验证 - 预算逻辑 | 已登录 | 1. 最低预算 > 最高预算<br>2. 点击下一步 | 提示「最高预算不能低于最低预算」 | P0 |
| FUNC-GEN-005 | 表单验证 - 日期 | 已登录 | 1. 不选择日期<br>2. 点击下一步 | 提示「请选择活动日期」 | P0 |
| FUNC-GEN-006 | 表单验证 - 地点 | 已登录 | 1. 不填写出发地点<br>2. 点击下一步 | 提示「请输入出发地点」 | P0 |
| FUNC-GEN-007 | 人数快捷选择 | 已登录 | 1. 点击「20人」<br>2. 观察人数输入 | 人数自动填充为 20，人均预算更新 | P1 |
| FUNC-GEN-008 | Stepper 组件 | 已登录 | 1. 点击「+」按钮<br>2. 点击「-」按钮 | 人数增加/减少，人均预算实时更新 | P1 |
| FUNC-GEN-009 | 实时人均预算计算 | 已登录 | 1. 输入预算 30000-60000<br>2. 人数 50 | 显示「人均 600-1200 元」 | P1 |
| FUNC-GEN-010 | 天数自动计算 | 已登录 | 1. 开始日期 2026-05-10<br>2. 结束日期 2026-05-11 | 显示「2 天」 | P1 |
| FUNC-GEN-011 | 上一步返回 | 在 Step 2 | 1. 点击「上一步」 | 返回 Step 1，数据保留 | P1 |
| FUNC-GEN-012 | 生成超时处理 | 已登录 | 1. 模拟超时<br>2. 生成方案 | 显示超时提示，可重试 | P1 |
| FUNC-GEN-013 | 预算不足提示 | 已登录 | 1. 预算过低<br>2. 生成方案 | 后端返回预算不足错误，前端提示调整预算 | P2 |

### 5.3 方案对比功能

| 用例ID | 测试项 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|----------|--------|
| FUNC-COMP-001 | 方案列表展示 | 生成成功 | 1. 查看对比页 | 显示 3 个方案，数据完整 | P0 |
| FUNC-COMP-002 | 推荐方案标识 | 生成成功 | 1. 查看方案卡片 | 平衡型方案显示「推荐」标签 | P1 |
| FUNC-COMP-003 | 方案选择 | 生成成功 | 1. 点击方案卡片 | 卡片显示选中状态，其他卡片取消选中 | P0 |
| FUNC-COMP-004 | 横向滚动 | 生成成功 | 1. 左右滑动 | 可流畅滚动查看所有方案 | P1 |
| FUNC-COMP-005 | 展开对比表 | 生成成功 | 1. 点击「查看详细对比」 | 对比表展开，显示对比数据 | P0 |
| FUNC-COMP-006 | 折叠对比表 | 对比表已展开 | 1. 再次点击 | 对比表折叠 | P1 |
| FUNC-COMP-007 | 查看详情 | 生成成功 | 1. 点击「查看详情」 | 跳转到该方案的详情页 | P0 |
| FUNC-COMP-008 | 选择方案 | 生成成功 | 1. 选中方案<br>2. 点击「选择此方案」 | 跳转到该方案的详情页 | P0 |
| FUNC-COMP-009 | 重新生成 | 生成成功 | 1. 点击「重新生成」 | 弹出确认弹窗，选择保留/重置输入 | P1 |

### 5.4 方案详情功能

| 用例ID | 测试项 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|----------|--------|
| FUNC-DETAIL-001 | 详情页展示 | 从对比页进入 | 1. 查看详情页 | 显示完整方案信息 | P0 |
| FUNC-DETAIL-002 | 行程展开/折叠 | 在详情页 | 1. 点击行程面板标题 | 面板展开/折叠，动画流畅 | P1 |
| FUNC-DETAIL-003 | 预算展开/折叠（非MVP） | 在详情页 | - | 不展示预算明细模块 | P1 |
| FUNC-DETAIL-004 | 供应商展开/折叠（非MVP） | 在详情页 | - | 不展示供应商模块 | P1 |
| FUNC-DETAIL-005 | 拨打电话（非MVP） | 在详情页 | - | 不展示供应商模块 | P0 |
| FUNC-DETAIL-006 | 复制微信号（非MVP） | 在详情页 | - | 不展示供应商模块 | P0 |
| FUNC-DETAIL-007 | 确认方案 | 在详情页 | 1. 点击「确认选择此方案」 | 调用确认 API，成功后显示提示，跳转到我的方案 | P0 |
| FUNC-DETAIL-008 | 确认失败处理 | 在详情页 | 1. 模拟网络错误<br>2. 确认方案 | 显示失败提示，可重试 | P1 |

### 5.5 我的方案功能

| 用例ID | 测试项 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|--------|--------|----------|----------|----------|--------|
| FUNC-MY-001 | 方案列表加载 | 已有方案 | 1. 打开我的方案页 | 显示所有已确认的方案列表 | P0 |
| FUNC-MY-002 | 空状态显示 | 无方案 | 1. 打开我的方案页 | 显示空状态，引导去生成方案 | P1 |
| FUNC-MY-003 | 点击方案卡片 | 已有方案 | 1. 点击方案卡片 | 跳转到该方案详情页 | P0 |
| FUNC-MY-004 | 滑动删除 | 已有方案 | 1. 向左滑动卡片<br>2. 点击删除 | 弹出确认弹窗，确认后删除方案 | P1 |
| FUNC-MY-005 | 下拉刷新 | 已有方案 | 1. 下拉页面 | 显示刷新动画，重新加载数据 | P1 |
| FUNC-MY-006 | 分页加载 | 方案超过 10 个 | 1. 滚动到底部 | 自动加载更多方案 | P2 |
| FUNC-MY-007 | 状态筛选 | 已有方案 | 1. 选择状态筛选 | 只显示对应状态的方案 | P2 |

---

## 6. 集成测试用例

### 6.1 端到端流程测试

| 用例ID | 测试场景 | 测试步骤 | 预期结果 | 优先级 |
|--------|----------|----------|----------|--------|
| INT-E2E-001 | 完整业务流程 | 1. 登录<br>2. 填写需求<br>3. 生成方案<br>4. 对比方案<br>5. 查看详情<br>6. 确认方案<br>7. 查看我的方案 | 整个流程顺畅，数据正确传递，最终方案保存成功 | P0 |
| INT-E2E-002 | 多次生成流程 | 1. 生成方案 A<br>2. 查看对比<br>3. 返回重新生成方案 B<br>4. 确认方案 B | 多次生成互不影响，最新方案正确保存 | P1 |
| INT-E2E-003 | 跨页面数据保持 | 1. 填写表单<br>2. 切换到我的方案<br>3. 返回首页 | 表单数据保持不变 | P1 |

### 6.2 与后端 API 集成测试

| 用例ID | 测试场景 | API 端点 | 测试步骤 | 预期结果 | 优先级 |
|--------|----------|----------|----------|----------|--------|
| INT-API-001 | 用户登录 | POST /users/login | 1. 调用登录 API<br>2. 传入 code 和 userInfo | 返回 sessionToken 和用户信息 | P0 |
| INT-API-002 | 生成方案 | POST /plans/generate | 1. 传入需求数据<br>2. 等待响应 | 返回 3 个方案数据（不包含预算明细） | P0 |
| INT-API-003 | 获取方案列表 | GET /plans | 1. 请求方案列表 | 返回当前用户的所有方案 | P0 |
| INT-API-004 | 确认方案 | POST /plans/:id/confirm | 1. 传入 plan_id<br>2. 调用确认 API | 返回成功状态，方案状态变更为已确认 | P0 |
| INT-API-005 | 401 未授权处理 | 任意需要登录的 API | 1. 清除 token<br>2. 调用 API | 自动跳转到登录页 | P1 |
| INT-API-006 | 网络超时处理 | 任意 API | 1. 模拟超时<br>2. 调用 API | 显示超时提示，可重试 | P1 |

### 6.3 与 AI 服务集成测试

| 用例ID | 测试场景 | 测试步骤 | 预期结果 | 优先级 |
|--------|----------|----------|----------|--------|
| INT-AI-001 | AI 方案生成 | 1. 提交需求<br>2. 等待 AI 生成 | Python AI 服务处理请求，通过 RabbitMQ 异步返回 | P0 |
| INT-AI-002 | AI 生成超时 | 1. 提交需求<br>2. 超过 2 分钟 | 显示超时提示，可重试 | P1 |
| INT-AI-003 | AI 生成失败 | 1. 提交无效需求<br>2. AI 返回错误 | 显示友好错误提示 | P1 |

---

## 7. API 测试用例

### 7.1 用户相关 API

#### POST /users/login - 用户登录

**请求参数**:
```json
{
  "code": "wx_auth_code",
  "userInfo": {
    "nickName": "测试用户",
    "avatarUrl": "https://..."
  }
}
```

**测试用例**:

| 用例ID | 测试场景 | 输入 | 预期输出 | HTTP 状态码 |
|--------|----------|------|----------|-------------|
| API-LOGIN-001 | 正常登录 | 有效 code 和 userInfo | 返回 sessionToken 和用户信息 | 200 |
| API-LOGIN-002 | code 无效 | 无效 code | 返回错误提示 | 400 |
| API-LOGIN-003 | 缺少参数 | 缺少 code | 返回参数错误 | 400 |

### 7.2 方案相关 API

#### POST /plans/generate - 生成方案

**请求参数**:
```json
{
  "people_count": 50,
  "budget_min": 30000,
  "budget_max": 60000,
  "start_date": "2026-05-10",
  "end_date": "2026-05-11",
  "departure_location": "北京",
  "preferences": {
    "activity_types": ["team_building", "leisure"],
    "accommodation_level": "standard",
    "dining_style": ["local", "bbq"],
    "special_requirements": ""
  }
}
```

**测试用例**:

| 用例ID | 测试场景 | 输入 | 预期输出 | HTTP 状态码 |
|--------|----------|------|----------|-------------|
| API-GEN-001 | 正常生成 | 完整有效参数 | 返回 3 个方案 | 200 |
| API-GEN-002 | 预算不足 | budget_min = 100 | 返回预算不足错误 | 400 |
| API-GEN-003 | 人数无效 | people_count = 0 | 返回参数错误 | 400 |
| API-GEN-004 | 日期无效 | start_date > end_date | 返回日期错误 | 400 |
| API-GEN-005 | 未登录 | 无 token | 返回未授权错误 | 401 |
| API-GEN-006 | 生成超时 | 正常请求但超时 | 返回超时错误 | 504 |

#### GET /plans - 获取方案列表

**查询参数**:
```
?page=1&pageSize=10&status=confirmed
```

**测试用例**:

| 用例ID | 测试场景 | 输入 | 预期输出 | HTTP 状态码 |
|--------|----------|------|----------|-------------|
| API-LIST-001 | 获取全部 | 无筛选 | 返回所有方案 | 200 |
| API-LIST-002 | 状态筛选 | status=confirmed | 只返回已确认方案 | 200 |
| API-LIST-003 | 分页 | page=2&pageSize=5 | 返回第 2 页数据 | 200 |
| API-LIST-004 | 未登录 | 无 token | 返回未授权错误 | 401 |

#### POST /plans/:id/confirm - 确认方案

**请求参数**:
```json
{
  "plan_id": "plan_001"
}
```

**测试用例**:

| 用例ID | 测试场景 | 输入 | 预期输出 | HTTP 状态码 |
|--------|----------|------|----------|-------------|
| API-CONFIRM-001 | 正常确认 | 有效 plan_id | 返回成功状态 | 200 |
| API-CONFIRM-002 | 方案不存在 | 无效 plan_id | 返回 404 错误 | 404 |
| API-CONFIRM-003 | 重复确认 | 已确认的方案 | 返回已确认提示 | 400 |
| API-CONFIRM-004 | 未登录 | 无 token | 返回未授权错误 | 401 |

---

## 8. 性能测试用例

### 8.1 加载性能

| 用例ID | 测试项 | 测试步骤 | 性能指标 | 优先级 |
|--------|--------|----------|----------|--------|
| PERF-LOAD-001 | 首页加载时间 | 打开首页 | < 1 秒 | P1 |
| PERF-LOAD-002 | 方案列表加载 | 打开我的方案页 | < 1.5 秒 | P1 |
| PERF-LOAD-003 | 详情页加载 | 打开方案详情 | < 1 秒 | P1 |

### 8.2 响应性能

| 用例ID | 测试项 | 测试步骤 | 性能指标 | 优先级 |
|--------|--------|----------|----------|--------|
| PERF-RESP-001 | 表单输入响应 | 输入文字 | 实时响应，无延迟 | P1 |
| PERF-RESP-002 | 滚动流畅度 | 滚动列表 | 60 FPS，无卡顿 | P1 |
| PERF-RESP-003 | 动画流畅度 | 展开/折叠面板 | 流畅，无掉帧 | P2 |

### 8.3 API 性能

| 用例ID | 测试项 | 测试步骤 | 性能指标 | 优先级 |
|--------|--------|----------|----------|--------|
| PERF-API-001 | 登录 API | 调用登录接口 | < 500 ms | P1 |
| PERF-API-002 | 生成方案 API | 调用生成接口 | < 30 秒（AI 处理时间） | P0 |
| PERF-API-003 | 获取列表 API | 调用列表接口 | < 500 ms | P1 |

### 8.4 并发测试

| 用例ID | 测试项 | 测试步骤 | 性能指标 | 优先级 |
|--------|--------|----------|----------|--------|
| PERF-CONC-001 | 10 用户同时生成方案 | 模拟 10 个并发请求 | 全部成功，响应时间 < 35 秒 | P2 |
| PERF-CONC-002 | 50 用户同时登录 | 模拟 50 个并发登录 | 全部成功，响应时间 < 1 秒 | P2 |

---

## 9. 边界测试用例

### 9.1 输入边界测试

| 用例ID | 测试项 | 测试输入 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| BOUND-INPUT-001 | 人数最小值 | 1 人 | 接受，正常生成 | P1 |
| BOUND-INPUT-002 | 人数最大值 | 999 人 | 接受，正常生成 | P1 |
| BOUND-INPUT-003 | 人数为 0 | 0 人 | 拒绝，提示错误 | P0 |
| BOUND-INPUT-004 | 人数为负数 | -10 人 | 拒绝，提示错误 | P1 |
| BOUND-INPUT-005 | 预算最小值 | 100 元 | 接受或提示预算不足 | P1 |
| BOUND-INPUT-006 | 预算超大值 | 10,000,000 元 | 接受，正常生成 | P2 |
| BOUND-INPUT-007 | 预算为 0 | 0 元 | 拒绝，提示错误 | P0 |
| BOUND-INPUT-008 | 特殊字符输入 | 出发地 "北京<script>" | 自动转义，防止 XSS | P1 |
| BOUND-INPUT-009 | 超长文本 | 特殊需求 10000 字 | 限制字数或截断 | P2 |
| BOUND-INPUT-010 | 空字符串 | 出发地为空格 | 提示输入有效地点 | P1 |

### 9.2 日期边界测试

| 用例ID | 测试项 | 测试输入 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| BOUND-DATE-001 | 开始日期 = 结束日期 | 同一天 | 接受，天数为 1 | P1 |
| BOUND-DATE-002 | 开始日期 > 结束日期 | 倒序日期 | 拒绝，提示错误 | P0 |
| BOUND-DATE-003 | 历史日期 | 过去的日期 | 警告或拒绝 | P2 |
| BOUND-DATE-004 | 超远未来日期 | 10 年后 | 接受或警告 | P2 |

### 9.3 数据边界测试

| 用例ID | 测试项 | 测试场景 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| BOUND-DATA-001 | 方案列表为空 | 无方案数据 | 显示空状态 | P1 |
| BOUND-DATA-002 | 方案列表超多 | 100+ 方案 | 分页加载，不卡顿 | P2 |
| BOUND-DATA-003 | 行程项超多 | 50+ 行程项 | 正常显示，可滚动 | P2 |
| BOUND-DATA-004 | 供应商超多（非MVP） | 20+ 供应商 | 不展示供应商模块 | P2 |

---

## 10. 兼容性测试用例

### 10.1 微信版本兼容性

| 用例ID | 测试项 | 测试环境 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| COMPAT-WX-001 | 最新微信版本 | 微信 8.0.x | 所有功能正常 | P0 |
| COMPAT-WX-002 | 微信 7.0.x | 微信 7.0.x | 核心功能正常 | P1 |
| COMPAT-WX-003 | 基础库 2.33.0 | 基础库 2.33.0+ | 所有功能正常 | P0 |

### 10.2 设备兼容性

| 用例ID | 测试项 | 测试设备 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| COMPAT-DEV-001 | iPhone 14 | iOS 16+ | 所有功能正常 | P0 |
| COMPAT-DEV-002 | iPhone X | iOS 14+ | 核心功能正常 | P1 |
| COMPAT-DEV-003 | 华为 Mate 40 | Android 11+ | 所有功能正常 | P0 |
| COMPAT-DEV-004 | 小米 11 | Android 11+ | 所有功能正常 | P0 |
| COMPAT-DEV-005 | 小屏设备 | iPhone SE | 布局适配正常 | P1 |
| COMPAT-DEV-006 | 大屏设备 | iPad | 布局适配正常 | P2 |

### 10.3 网络兼容性

| 用例ID | 测试项 | 网络环境 | 预期结果 | 优先级 |
|--------|--------|----------|----------|--------|
| COMPAT-NET-001 | WiFi | 正常 WiFi | 所有功能正常 | P0 |
| COMPAT-NET-002 | 4G | 4G 网络 | 功能正常，加载稍慢 | P0 |
| COMPAT-NET-003 | 3G | 3G 网络 | 功能正常，显示加载状态 | P1 |
| COMPAT-NET-004 | 弱网 | 模拟弱网 | 显示加载状态，超时提示 | P1 |
| COMPAT-NET-005 | 离线 | 无网络 | 显示网络错误提示 | P1 |
| COMPAT-NET-006 | 网络切换 | WiFi ↔ 4G | 自动恢复连接 | P2 |

---

## 11. 测试数据

### 11.1 标准测试数据

#### 数据集 1: 正常场景

```json
{
  "people_count": 50,
  "budget_min": 30000,
  "budget_max": 60000,
  "start_date": "2026-05-10",
  "end_date": "2026-05-11",
  "departure_location": "北京",
  "preferences": {
    "activity_types": ["team_building", "leisure"],
    "accommodation_level": "standard",
    "dining_style": ["local", "bbq"],
    "special_requirements": ""
  }
}
```

#### 数据集 2: 小型团建

```json
{
  "people_count": 20,
  "budget_min": 15000,
  "budget_max": 25000,
  "start_date": "2026-06-01",
  "end_date": "2026-06-02",
  "departure_location": "上海",
  "preferences": {
    "activity_types": ["culture"],
    "accommodation_level": "budget",
    "dining_style": ["local"],
    "special_requirements": "需要无障碍设施"
  }
}
```

#### 数据集 3: 大型团建

```json
{
  "people_count": 150,
  "budget_min": 200000,
  "budget_max": 300000,
  "start_date": "2026-07-15",
  "end_date": "2026-07-17",
  "departure_location": "深圳",
  "preferences": {
    "activity_types": ["team_building", "sports"],
    "accommodation_level": "premium",
    "dining_style": ["western", "hotpot"],
    "special_requirements": "需要会议室和投影设备"
  }
}
```

#### 数据集 4: 边界值测试

```json
{
  "people_count": 1,
  "budget_min": 500,
  "budget_max": 1000,
  "start_date": "2026-08-01",
  "end_date": "2026-08-01",
  "departure_location": "杭州",
  "preferences": {
    "activity_types": ["leisure"],
    "accommodation_level": "budget",
    "dining_style": ["local"],
    "special_requirements": ""
  }
}
```

### 11.2 异常测试数据

#### 数据集 5: 预算不足

```json
{
  "people_count": 100,
  "budget_min": 1000,
  "budget_max": 2000,
  ...
}
```

#### 数据集 6: 无效日期

```json
{
  "start_date": "2026-12-31",
  "end_date": "2026-01-01",
  ...
}
```

### 11.3 用户账号

| 角色 | 微信账号 | 说明 |
|------|----------|------|
| 普通用户 | 测试号 | 用于功能测试 |
| VIP 用户 | 测试号 | 用于权限测试 |

---

## 12. 测试报告模板

### 12.1 测试执行记录

```markdown
# TeamVenture 小程序测试报告

**测试日期**: 2026-01-XX
**测试人员**: XXX
**测试版本**: v1.0
**测试环境**: Local / Dev / Beta

## 测试概况

| 项目 | 数量 |
|------|------|
| 总用例数 | XXX |
| 执行用例数 | XXX |
| 通过用例数 | XXX |
| 失败用例数 | XXX |
| 阻塞用例数 | XXX |
| 用例通过率 | XX% |

## 测试结果统计

### 按模块统计

| 模块 | 总用例 | 通过 | 失败 | 阻塞 | 通过率 |
|------|--------|------|------|------|--------|
| 登录模块 | XX | XX | XX | XX | XX% |
| 方案生成 | XX | XX | XX | XX | XX% |
| 方案对比 | XX | XX | XX | XX | XX% |
| 方案详情 | XX | XX | XX | XX | XX% |
| 我的方案 | XX | XX | XX | XX | XX% |

### 按优先级统计

| 优先级 | 总用例 | 通过 | 失败 | 阻塞 | 通过率 |
|--------|--------|------|------|------|--------|
| P0 | XX | XX | XX | XX | XX% |
| P1 | XX | XX | XX | XX | XX% |
| P2 | XX | XX | XX | XX | XX% |

## Bug 列表

### 严重 Bug (Blocker)

| Bug ID | 标题 | 模块 | 复现步骤 | 状态 |
|--------|------|------|----------|------|
| BUG-001 | XXX | XXX | XXX | Open |

### 一般 Bug (Normal)

| Bug ID | 标题 | 模块 | 复现步骤 | 状态 |
|--------|------|------|----------|------|
| BUG-002 | XXX | XXX | XXX | Open |

### 轻微 Bug (Minor)

| Bug ID | 标题 | 模块 | 复现步骤 | 状态 |
|--------|------|------|----------|------|
| BUG-003 | XXX | XXX | XXX | Open |

## 测试结论

### 测试完成度
- ✅ 已完成所有 P0 用例测试
- ✅ 已完成所有 P1 用例测试
- ⚠️ P2 用例部分完成

### 质量评估
- **功能完整性**: ⭐⭐⭐⭐⭐ (5/5)
- **性能表现**: ⭐⭐⭐⭐☆ (4/5)
- **用户体验**: ⭐⭐⭐⭐⭐ (5/5)
- **稳定性**: ⭐⭐⭐⭐☆ (4/5)

### 建议
1. XXX
2. XXX
3. XXX

### 上线风险评估
- 🟢 低风险 / 🟡 中风险 / 🔴 高风险

### 测试负责人签名
XXX
```

---

## 附录

### A. 测试工具

- **微信开发者工具**: 用于小程序调试
- **Postman**: 用于 API 测试
- **Chrome DevTools**: 用于网络请求调试
- **Docker Desktop**: 用于后端服务管理

### B. 参考文档

- [微信小程序官方文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [项目 README](./README.md)
- [本地测试指南](./LOCAL_TEST_GUIDE.md)
- [UX/UI 设计规范](../docs/design/miniapp-ux-ui-specification.md)

### C. 联系方式

遇到问题请联系：
- 前端开发: XXX
- 后端开发: XXX
- 测试负责人: XXX

---

**文档版本**: v1.0
**最后更新**: 2026-01-02
**文档状态**: ✅ Ready for Use
