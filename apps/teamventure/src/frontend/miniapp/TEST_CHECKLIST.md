# AI智能填充 - 测试清单

## 快速验证（5分钟）

### ✅ 步骤1: 打开页面
- [ ] 在微信开发者工具中打开项目
- [ ] 导航到"生成方案"页面
- [ ] 确认看到紫色"✨ AI填充"按钮

### ✅ 步骤2: 测试基本流程
- [ ] 点击"AI填充"按钮
- [ ] 看到弹窗标题"AI 智能填充"
- [ ] 看到3个输入框：天数、出发地、到达地

### ✅ 步骤3: 测试正常输入
**输入**：
- 天数：`3`
- 出发地：`北京`
- 到达地：`青岛`

**操作**：点击"确认填充"

**预期结果**：
- [ ] 弹窗关闭
- [ ] 显示Toast "AI填充完成"
- [ ] textarea中生成完整模板
- [ ] 包含"3天2夜"标题
- [ ] 包含北京→青岛路线
- [ ] 包含2晚住宿安排（第1、2日）
- [ ] 第3日标记"当日返程，无需入住"

### ✅ 步骤4: 测试异常输入

#### 4.1 空值校验
**输入**：天数留空，点击"确认填充"
- [ ] 显示提示："请输入天数"
- [ ] 弹窗不关闭

#### 4.2 范围校验（<1）
**输入**：天数`0`，出发地`上海`，到达地`杭州`，点击"确认填充"
- [ ] 显示提示："天数必须是1-9之间的数字"
- [ ] 弹窗不关闭

#### 4.3 范围校验（>9）
**输入**：天数`10`，出发地`广州`，到达地`深圳`，点击"确认填充"
- [ ] 显示提示："天数必须是1-9之间的数字"
- [ ] 弹窗不关闭

#### 4.4 非数字校验
**输入**：天数`abc`，点击"确认填充"
- [ ] 显示提示："天数必须是1-9之间的数字"
- [ ] 弹窗不关闭

### ✅ 步骤5: 测试途经点逻辑

#### 5.1 测试5天（1个途经点）
**输入**：天数`5`，出发地`广州`，到达地`云南`
- [ ] 生成模板包含"途径地: （建议第3天）"
- [ ] 住宿安排第3日为途经地酒店

#### 5.2 测试7天（2个途经点）
**输入**：天数`7`，出发地`上海`，到达地`成都`
- [ ] 生成模板包含"途径地1"和"途径地2"
- [ ] 途径地1建议第3天，途径地2建议第5天

#### 5.3 测试9天（3个途经点）
**输入**：天数`9`，出发地`北京`，到达地`西藏`
- [ ] 生成模板包含3个途径地
- [ ] 建议日期为第3、5、7天

### ✅ 步骤6: 测试边界情况

#### 6.1 测试1天（无住宿）
**输入**：天数`1`，出发地`北京`，到达地`天津`
- [ ] 住宿安排显示"<!-- 1天行程无需住宿安排 -->"
- [ ] 没有入住/出发信息

#### 6.2 测试2天（1晚）
**输入**：天数`2`，出发地`上海`，到达地`杭州`
- [ ] 第1日：有入住
- [ ] 第2日：有出发，标记"当日返程，无需入住"

## 高级测试（可选）

### 🔍 测试1: 中文输入
**输入**：天数`三`（中文数字）
- [ ] 校验失败："天数必须是1-9之间的数字"

### 🔍 测试2: 小数输入
**输入**：天数`3.5`
- [ ] parseInt后变为3，可以通过

### 🔍 测试3: 负数输入
**输入**：天数`-2`
- [ ] 校验失败："天数必须是1-9之间的数字"

### 🔍 测试4: 出发地/到达地为空
**输入**：天数`3`，出发地留空
- [ ] 显示提示："请输入出发地"

**输入**：天数`3`，出发地`北京`，到达地留空
- [ ] 显示提示："请输入到达地"

### 🔍 测试5: 特殊字符
**输入**：出发地`<script>alert(1)</script>`
- [ ] 正常填充（后端会做安全处理）

## 性能验证

### 响应速度
- [ ] 点击"AI填充"按钮 → 弹窗弹出 < 100ms
- [ ] 输入天数 → 数据更新 < 50ms
- [ ] 点击"确认填充" → 模板生成 < 200ms

### 内存占用
- [ ] 打开弹窗前后内存无明显增长
- [ ] 关闭弹窗后资源正常释放

## 回归测试

确保旧功能未受影响：

### 基础功能
- [ ] "🔄 重置"按钮仍然可用
- [ ] 手动修改markdown内容正常
- [ ] 草稿保存/恢复功能正常
- [ ] "AI 生成方案"按钮正常提交

### 页面跳转
- [ ] 从首页跳转到生成方案页正常
- [ ] 生成成功后跳转到我的方案页正常

## 验收标准

### 必须通过（P0）
- [x] 天数输入框可以正常输入
- [x] 1-9范围校验生效
- [x] 空值校验生效
- [x] 非数字校验生效
- [x] 生成模板逻辑正确（途经点、住宿）

### 建议通过（P1）
- [ ] 输入框聚焦后弹出数字键盘
- [ ] 输入框placeholder清晰
- [ ] 错误提示文案友好

### 可选通过（P2）
- [ ] 输入框支持清除按钮
- [ ] 天数输入时显示实时提示

## 已知限制

1. **天数上限为9天**：超过9天的行程需要手动编写
2. **途经点固定位置**：5天第3天、7天第3/5天、9天第3/5/7天
3. **小数会自动取整**：如输入3.8，会按3天处理

## 快速调试

如果遇到问题，检查以下内容：

### Console日志
```javascript
// 在handleConfirmAIFill中添加
console.log('输入值:', { days, origin, destination })
console.log('解析后天数:', daysNum)
console.log('校验结果:', isNaN(daysNum), daysNum < 1, daysNum > 9)
```

### 数据绑定
```javascript
// 在Console中执行
getCurrentPages()[0].data.aiFillData
// 应显示: { days: '3', origin: '北京', destination: '青岛' }
```

### 模板生成
```javascript
// 在test-ai-fill.js中测试
node test-ai-fill.js
// 查看各种天数的生成效果
```

## 测试完成标志

所有必须通过项（P0）打勾 ✅ → 功能可以发布

发现问题请记录在下方：

---

**测试人员**: ___________
**测试日期**: ___________
**测试环境**: 微信开发者工具 / 真机
**问题记录**:
-
-
