# AI 智能填充功能说明

## 功能概述

用户只需填写**3个核心参数**（天数、出发地、到达地），AI将自动生成符合行程逻辑的完整Markdown模板。

## 使用方式

1. 点击页面顶部的"✨ AI填充"按钮
2. 在弹窗中填写：
   - **天数**：选择1-9天
   - **出发地**：如"北京"
   - **到达地**：如"青岛"
3. 点击"确认填充"
4. AI自动生成完整模板，用户可继续微调

## 位移-驻留逻辑

根据旅行天数，AI会智能安排"位移"（交通）和"驻留"（住宿活动）：

### 1天旅行
```
去 → 玩 → 回
（位移 → 驻留 → 位移）
```
**无住宿安排**

### 2天旅行
```
Day1: 去 → 玩（位移 → 驻留）
Day2: 玩 → 回（驻留 → 位移）
```
**1晚住宿**

### 3天旅行
```
Day1: 去 → 玩（位移 → 驻留）
Day2: 玩（驻留）
Day3: 玩 → 回（驻留 → 位移）
```
**2晚住宿**

### 4天旅行
```
Day1: 去 → 玩（位移 → 驻留）
Day2: 玩（驻留）
Day3: 玩（驻留）
Day4: 玩 → 回（驻留 → 位移）
```
**3晚住宿**

### 5-6天旅行（1个途经点）
```
Day1: 去 → 玩
Day2: 玩
Day3: 玩 → 途经点（位移到途经地）← 途经点日
Day4: 途经点 → 玩
Day5: 玩 → 回
```
**途经点默认第3天**

### 7-8天旅行（2个途经点）
```
Day1: 去 → 玩
Day2: 玩
Day3: 玩 → 途经点1 ← 途经点日
Day4: 途经点1 → 玩
Day5: 玩 → 途经点2 ← 途经点日
Day6: 途经点2 → 玩
Day7: 玩 → 回
```
**途经点默认第3天、第5天**

### 9天及以上旅行（3个途经点）
```
Day1: 去 → 玩
Day2: 玩
Day3: 玩 → 途经点1 ← 途经点日
Day4: 途经点1 → 玩
Day5: 玩 → 途经点2 ← 途经点日
Day6: 途经点2 → 玩
Day7: 玩 → 途经点3 ← 途经点日
Day8: 途经点3 → 玩
Day9: 玩 → 回
```
**途经点默认第3天、第5天、第7天**

## 生成示例

### 示例1：3天北京→青岛

**输入**：
- 天数：3天
- 出发地：北京
- 到达地：青岛

**AI生成结果**：
```markdown
# 团建行程方案

## 基本信息
- **天数**: 3天2夜
- **人数**: 30人
- **预算**: ¥500 - ¥800/人

## 行程路线
- **出发地**: 北京
- **到达地**: 青岛

## 交通安排
### 去程
- **方式**: 高铁/航班（北京 → 青岛，请填写具体班次和时间）

### 返程
- **方式**: 高铁/航班（青岛 → 北京，请填写具体班次和时间）

## 住宿安排
### 第一日
- **入住**: 青岛XX酒店（请填写具体酒店名称和星级）

### 第二日
- **出发**: 青岛XX酒店
- **入住**: 青岛XX度假村（或续住前一酒店）

### 第三日
- **出发**: 青岛XX度假村
<!-- 当日返程，无需入住 -->

## 活动偏好
- 团队协作（如：拓展训练、团队挑战）
- 文化体验（如：当地特色、历史古迹）
- 休闲娱乐（如：美食品鉴、自由活动）

## 特殊要求
- 如有老人/小孩、饮食限制等特殊需求，请在此填写
- 如无特殊要求可删除此段
```

### 示例2：7天上海→成都（含2个途经点）

**输入**：
- 天数：7天
- 出发地：上海
- 到达地：成都

**AI生成结果**：
```markdown
# 团建行程方案

## 基本信息
- **天数**: 7天6夜
- **人数**: 30人
- **预算**: ¥500 - ¥800/人

## 行程路线
- **出发地**: 上海
- **到达地**: 成都
- **途径地1**: （建议第3天，请填写具体城市）
- **途径地2**: （建议第5天，请填写具体城市）

## 交通安排
### 去程
- **方式**: 高铁/航班（上海 → 成都，请填写具体班次和时间）

### 返程
- **方式**: 高铁/航班（成都 → 上海，请填写具体班次和时间）

## 住宿安排
### 第一日
- **入住**: 成都XX酒店（请填写具体酒店名称和星级）

### 第二日
- **出发**: 成都XX酒店
- **入住**: 成都XX度假村（或续住前一酒店）

### 第三日
- **出发**: 前一站酒店
- **入住**: 途径地1XX酒店（请填写具体酒店名称）

### 第四日
- **出发**: 成都XX酒店
- **入住**: 成都XX度假村（或续住前一酒店）

### 第五日
- **出发**: 前一站酒店
- **入住**: 途径地2XX酒店（请填写具体酒店名称）

### 第六日
- **出发**: 成都XX酒店
- **入住**: 成都XX度假村（或续住前一酒店）

### 第七日
- **出发**: 成都XX度假村
<!-- 当日返程，无需入住 -->

## 活动偏好
- 团队协作（如：拓展训练、团队挑战）
- 文化体验（如：当地特色、历史古迹）
- 休闲娱乐（如：美食品鉴、自由活动）

## 特殊要求
- 如有老人/小孩、饮食限制等特殊需求，请在此填写
- 如无特殊要求可删除此段
```

## 无效内容标记

对于**无途经点**或**无住宿**的情况，使用Markdown注释标记为"可见但无效"：

```markdown
<!-- 1天行程无需住宿安排 -->
<!-- 当日返程，无需入住 -->
```

这些注释在小程序中不会渲染显示，但保留在Markdown中便于后端解析时识别行程逻辑。

## 天数与途经点映射表

| 天数 | 途经点数量 | 途经点默认日 | 住宿晚数 |
|------|-----------|-------------|---------|
| 1天  | 0         | -           | 0       |
| 2天  | 0         | -           | 1       |
| 3天  | 0         | -           | 2       |
| 4天  | 0         | -           | 3       |
| 5-6天| 1         | 第3天       | 4-5     |
| 7-8天| 2         | 第3天、第5天 | 6-7     |
| 9天+ | 3         | 第3天、第5天、第7天 | 8+      |

## 用户后续操作

AI填充后，用户可以：
1. 补充具体的交通班次和时间
2. 填写酒店名称和星级
3. 补充途经地城市名称（如有）
4. 调整活动偏好
5. 添加特殊要求
6. 直接点击"AI 生成方案"

## 设计优势

✅ **降低输入成本**：从填写20+字段 → 只填3个核心字段
✅ **逻辑自动化**：AI根据天数自动安排途经点和住宿
✅ **保持灵活性**：生成后仍可手动调整
✅ **避免逻辑错误**：自动处理最后一天无住宿、途经点插入等复杂逻辑

## 测试清单

- [ ] 点击"AI填充"按钮正常弹出弹窗
- [ ] 天数选择器正常工作（1-9天）
- [ ] 出发地、到达地输入框正常
- [ ] 未填写必填项时有提示
- [ ] 1天行程：无住宿，只有交通安排
- [ ] 2天行程：1晚住宿，第2天标记无住宿
- [ ] 3天行程：2晚住宿，第3天标记无住宿
- [ ] 5天行程：1个途经点在第3天
- [ ] 7天行程：2个途经点在第3、5天
- [ ] 9天行程：3个途经点在第3、5、7天
- [ ] 生成后可以继续手动修改
- [ ] 点击"重置"恢复原模板

## 更新记录

- **2026-01-16**: 创建AI智能填充功能
  - 添加AI填充按钮和弹窗UI
  - 实现基于天数的模板生成逻辑
  - 支持1-9天行程自动规划
  - 智能处理途经点插入（5/7/9天）
  - 使用Markdown注释标记无效内容
