# AI填充功能优化 - 简化天数输入

## 改进内容

### ❌ 旧版本（选择器）
```xml
<picker mode="selector" range="{{daysOptions}}">
  <view>31天 ▼</view>
</picker>
```
**问题**：
- 选择器过于复杂，需要点击展开
- 默认值显示异常（出现"31天"）
- 交互步骤多（点击→滚动→确认）

### ✅ 新版本（数字输入框）
```xml
<input type="digit" placeholder="如：3" />
```
**优势**：
- 直接输入数字，更快捷
- 输入即校验，实时反馈
- 交互步骤少（直接输入）

## 校验规则

### 输入校验
```javascript
handleDaysInput(e) {
  const value = e.detail.value
  this.setData({ 'aiFillData.days': value })
}
```

### 提交校验
```javascript
handleConfirmAIFill() {
  const daysNum = parseInt(days)

  // 规则1: 必须填写
  if (!days) {
    showToast('请输入天数')
    return
  }

  // 规则2: 必须是数字
  if (isNaN(daysNum)) {
    showToast('天数必须是1-9之间的数字')
    return
  }

  // 规则3: 范围限制（1-9天）
  if (daysNum < 1 || daysNum > 9) {
    showToast('天数必须是1-9之间的数字')
    return
  }
}
```

## 测试用例

### 正常输入
| 输入 | 结果 | 说明 |
|------|------|------|
| 1 | ✅ 通过 | 1天旅行（无住宿） |
| 3 | ✅ 通过 | 3天2夜（2晚住宿） |
| 5 | ✅ 通过 | 5天4夜（1个途经点） |
| 9 | ✅ 通过 | 9天8夜（3个途经点） |

### 异常输入
| 输入 | 结果 | 提示信息 |
|------|------|---------|
| （空） | ❌ 拒绝 | "请输入天数" |
| 0 | ❌ 拒绝 | "天数必须是1-9之间的数字" |
| 10 | ❌ 拒绝 | "天数必须是1-9之间的数字" |
| abc | ❌ 拒绝 | "天数必须是1-9之间的数字" |
| 3.5 | ❌ 拒绝 | parseInt后为3，可通过（自动取整）|

## 界面对比

### 旧版（选择器）
```
┌───────────────────────────────┐
│ 天数 *                        │
│ ┌─────────────────────────┐   │
│ │ 31天                 ▼ │   │  ← 需要点击展开
│ └─────────────────────────┘   │
└───────────────────────────────┘
```

### 新版（输入框）
```
┌───────────────────────────────┐
│ 天数（1-9天）*                │
│ ┌─────────────────────────┐   │
│ │ 如：3                   │   │  ← 直接输入
│ └─────────────────────────┘   │
└───────────────────────────────┘
```

## 交互流程

### 用户操作
```
1. 点击"✨ AI填充"按钮
   ↓
2. 输入天数: 3
   ↓
3. 输入出发地: 北京
   ↓
4. 输入到达地: 青岛
   ↓
5. 点击"确认填充"
   ↓
6. 校验通过 → AI生成模板
   或
   校验失败 → 显示错误提示
```

### 校验时机
- **输入时**: 允许任意输入（不阻断）
- **提交时**: 严格校验（1-9范围）

## 错误提示示例

### 场景1：未填写天数
```
用户点击"确认填充"但天数为空
↓
显示Toast: "请输入天数"
```

### 场景2：天数超出范围
```
用户输入: 15
点击"确认填充"
↓
显示Toast: "天数必须是1-9之间的数字"
```

### 场景3：天数为非数字
```
用户输入: abc
点击"确认填充"
↓
显示Toast: "天数必须是1-9之间的数字"
```

## 代码修改清单

### 1. WXML（pages/index/index.wxml）
- ✅ 移除`<picker>`组件
- ✅ 改为`<input type="digit">`
- ✅ 更新label文案为"天数（1-9天）"

### 2. WXSS（pages/index/index.wxss）
- ✅ 移除`.fill-picker`相关样式
- ✅ 移除`.picker-display`和`.picker-arrow`样式
- ✅ 保留`.fill-input`样式（输入框通用）

### 3. JS（pages/index/index.js）
- ✅ 移除`daysOptions`数组
- ✅ 移除`aiFillData.daysIndex`字段
- ✅ 改`handleDaysChange`为`handleDaysInput`
- ✅ 在`handleConfirmAIFill`中添加三重校验：
  - 是否为空
  - 是否为数字
  - 是否在1-9范围内

## 优势总结

### 用户体验
- ⚡ **更快**：直接输入 vs 选择器滚动
- 🎯 **更准**：数字键盘，输入更精确
- 💡 **更简**：一个输入框，简单明了

### 技术实现
- 🔧 **更轻**：移除picker数据数组
- 🛡️ **更安全**：三重校验保证数据有效性
- 📱 **更原生**：使用系统数字键盘

## 下一步计划

### 短期优化
- [ ] 添加实时校验提示（输入时显示"1-9"范围）
- [ ] 天数输入框右侧添加"天"单位文字
- [ ] 支持上下箭头快速调整天数

### 长期优化
- [ ] 根据出发地和到达地推荐合理天数
- [ ] AI预填充推荐值（基于历史数据）
- [ ] 支持自定义天数上限（如允许10-15天）

## 更新记录

**2026-01-16 15:42**
- 将天数选择器改为数字输入框
- 添加1-9范围校验
- 简化交互流程
- 修复默认值显示异常问题
