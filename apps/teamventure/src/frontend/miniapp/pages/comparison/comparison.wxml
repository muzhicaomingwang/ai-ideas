<!--pages/comparison/comparison.wxml-->
<view class="comparison-page">
  <!-- æ ‡é¢˜ -->
  <view class="page-header">
    <view class="header-title">ä¸ºæ‚¨ç”Ÿæˆäº† 3 å¥—æ–¹æ¡ˆ</view>
    <view class="header-subtitle">è¯·é€‰æ‹©æœ€é€‚åˆæ‚¨çš„æ–¹æ¡ˆ</view>
  </view>

  <!-- æ–¹æ¡ˆå¡ç‰‡åˆ—è¡¨ -->
  <view class="plans-container">
    <scroll-view scroll-x="true" class="plans-scroll">
      <view class="plans-wrapper">
        <view
          wx:for="{{plans}}"
          wx:key="plan_id"
          class="plan-card {{item.plan_type}} {{selectedPlanId === item.plan_id ? 'selected' : ''}}"
          bindtap="handleSelectPlan"
          data-plan-id="{{item.plan_id}}"
        >
          <!-- æ¨èæ ‡ç­¾ -->
          <view class="recommended-badge" wx:if="{{item.recommended}}">
            â­ æ¨è
          </view>

          <!-- æ–¹æ¡ˆç±»å‹ -->
          <view class="plan-header">
            <view class="plan-name">{{item.plan_name}}</view>
            <view class="plan-type-label">{{item.plan_type_label}}</view>
          </view>

          <!-- é‡‘é¢ -->
          <view class="plan-budget">
            <view class="budget-total">Â¥{{item.budget_total}}</view>
            <view class="budget-per-person">{{item.budget_per_person}}/äºº</view>
          </view>

          <!-- æ–¹æ¡ˆäº®ç‚¹ -->
          <view class="plan-highlights">
            <view class="highlight-item">
              <text class="icon">ğŸ </text>
              <text class="label">{{item.accommodation_label}}</text>
            </view>
            <view class="highlight-item">
              <text class="icon">ğŸ¯</text>
              <text class="label">{{item.activity_count}}ä¸ªæ´»åŠ¨</text>
            </view>
            <view class="highlight-item">
              <text class="icon">ğŸ´</text>
              <text class="label">{{item.dining_label}}</text>
            </view>
          </view>

          <!-- é€‚åˆäººç¾¤ -->
          <view class="suitable-tags">
            <view
              wx:for="{{item.suitable_for}}"
              wx:for-item="tag"
              wx:key="*this"
              class="tag"
            >
              {{tag}}
            </view>
          </view>

          <!-- æ“ä½œæŒ‰é’® -->
          <view class="plan-actions">
            <button
              class="btn-detail"
              bindtap="handleViewDetail"
              data-plan-id="{{item.plan_id}}"
              catchtap="handleViewDetail"
            >
              æŸ¥çœ‹è¯¦æƒ…
            </button>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- è¯¦ç»†å¯¹æ¯”è¡¨æ ¼ -->
  <view class="comparison-section">
    <view class="section-header" bindtap="toggleComparison">
      <text class="section-title">è¯¦ç»†å¯¹æ¯”</text>
      <text class="toggle-icon">{{comparisonExpanded ? 'â–¼' : 'â–¶'}}</text>
    </view>

    <view class="comparison-table {{comparisonExpanded ? 'expanded' : ''}}">
      <view class="table-row header-row">
        <view class="table-cell">å¯¹æ¯”é¡¹</view>
        <view class="table-cell" wx:for="{{plans}}" wx:key="plan_id">
          {{item.plan_type_label}}
        </view>
      </view>

      <view class="table-row">
        <view class="table-cell label-cell">æ€»é¢„ç®—</view>
        <view class="table-cell" wx:for="{{plans}}" wx:key="plan_id">
          Â¥{{item.budget_total}}
        </view>
      </view>

      <view class="table-row">
        <view class="table-cell label-cell">äººå‡æˆæœ¬</view>
        <view class="table-cell" wx:for="{{plans}}" wx:key="plan_id">
          {{item.budget_per_person}}
        </view>
      </view>

      <view class="table-row">
        <view class="table-cell label-cell">ä½å®¿æ ‡å‡†</view>
        <view class="table-cell" wx:for="{{plans}}" wx:key="plan_id">
          {{item.accommodation_label}}
        </view>
      </view>

      <view class="table-row">
        <view class="table-cell label-cell">æ´»åŠ¨æ•°é‡</view>
        <view class="table-cell" wx:for="{{plans}}" wx:key="plan_id">
          {{item.activity_count}}ä¸ª
        </view>
      </view>

      <view class="table-row">
        <view class="table-cell label-cell">é¤é¥®æ ‡å‡†</view>
        <view class="table-cell" wx:for="{{plans}}" wx:key="plan_id">
          {{item.dining_label}}
        </view>
      </view>

      <view class="table-row">
        <view class="table-cell label-cell">é€‚åˆäººç¾¤</view>
        <view class="table-cell" wx:for="{{plans}}" wx:key="plan_id">
          {{item.suitable_for[0]}}
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-actions">
    <button class="btn-regenerate" bindtap="handleRegenerate">
      é‡æ–°ç”Ÿæˆ
    </button>
    <button
      class="btn-select-plan"
      bindtap="handleConfirmSelection"
      disabled="{{!selectedPlanId}}"
    >
      é€‰æ‹©æ­¤æ–¹æ¡ˆ
    </button>
  </view>
</view>
